<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="William Tirone">

<title>STA 602 HW 4</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="hw4_files/libs/clipboard/clipboard.min.js"></script>
<script src="hw4_files/libs/quarto-html/quarto.js"></script>
<script src="hw4_files/libs/quarto-html/popper.min.js"></script>
<script src="hw4_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="hw4_files/libs/quarto-html/anchor.min.js"></script>
<link href="hw4_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="hw4_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="hw4_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="hw4_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="hw4_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">STA 602 HW 4</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>William Tirone </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<section id="section" class="level1">
<h1>3.9</h1>
<p>a) To find the form of the prior, we can express the distribution in its exponential family form and pick out the components needed to construct the prior (using the notation from the book):</p>
<p><span class="math display">\[
Need: p(y) = h(y)c(\phi)e^{\phi t(y)}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
h(y) &amp; = \frac{2}{\Gamma(a)} y^{2a-1}\\
c(\phi) &amp; = \phi^a\\
t(y) &amp;= -y^2\\
\phi &amp;= \theta^2
\end{aligned}
\]</span></p>
<p>Now we know the prior will have the form:</p>
<p><span class="math display">\[
p(\phi) = k(n_0,t_0)c(\phi)^{n_0}e^{n_0t_0\phi} = k(n_0,t_0)\phi^{a n_0}e^{n_0t_0\theta^2}
\]</span></p>
<p>Now using the change of variables formula to get the prior on <span class="math inline">\(\theta = \sqrt\phi\)</span></p>
<p><span class="math display">\[
\begin{aligned}
p(\theta) &amp; = p(\phi) * |\frac{d\phi}{d \theta}| \\
&amp; = k(n_0,t_0) \theta^{2a * n_0} e^{n_0t_0\theta^2}  * 2\theta\\
&amp; \propto \theta^{2a * n_0 + 1}e^{n_0t_0\theta^2} \\
&amp; \sim galenshore(an_0+1 , \sqrt{-n_0t_0})
\end{aligned}
\]</span></p>
<p>Now attempting to plot these priors:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">1</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>n0 <span class="ot">=</span> <span class="fl">0.1</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">=</span> <span class="sc">-</span><span class="fl">0.1</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>theta<span class="ot">=</span> <span class="fu">sqrt</span>(<span class="sc">-</span>n0 <span class="sc">*</span> t0)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>values <span class="ot">=</span> (<span class="dv">2</span><span class="sc">/</span><span class="fu">gamma</span>(a<span class="sc">*</span>n0 <span class="sc">+</span> <span class="dv">1</span>)) <span class="sc">*</span> theta <span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>a) <span class="sc">*</span> y<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>a<span class="sc">*</span>n0<span class="sc">+</span><span class="dv">1</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">^</span>(<span class="sc">-</span>theta<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> y<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y,values,<span class="at">type=</span><span class="st">'l'</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>n0 <span class="ot">=</span> <span class="fl">0.1</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">=</span> <span class="sc">-</span><span class="fl">0.1</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fl">5.2</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>theta<span class="ot">=</span> <span class="fu">sqrt</span>(<span class="sc">-</span>n0 <span class="sc">*</span> t0)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>values2 <span class="ot">=</span> (<span class="dv">2</span><span class="sc">/</span><span class="fu">gamma</span>(a<span class="sc">*</span>n0 <span class="sc">+</span> <span class="dv">1</span>)) <span class="sc">*</span> theta <span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>a) <span class="sc">*</span> y<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>a<span class="sc">*</span>n0<span class="sc">+</span><span class="dv">1</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">^</span>(<span class="sc">-</span>theta<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> y<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,values2,<span class="at">type=</span><span class="st">'l'</span>,<span class="at">col=</span><span class="st">'blue'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>b)</p>
<p><img src="IMG_0013.PNG" class="img-fluid"> <img src="IMG_0014.PNG" class="img-fluid"></p>
<ol start="3" type="a">
<li>and d)</li>
</ol>
<p><img src="IMG_0015.PNG" class="img-fluid"></p>
<ol start="5" type="a">
<li></li>
</ol>
<p><img src="IMG_0016.PNG" class="img-fluid"></p>
</section>
<section id="section-1" class="level1">
<h1>2</h1>
<p>a)</p>
<p>Let <span class="math inline">\(\sum x_i = X\)</span> We have that <span class="math inline">\(\delta(x) = \frac{X+10}{n+1}\)</span>, so the bias, is:</p>
<p><span class="math display">\[
E(\delta(X)) - \theta \\
= \frac{10 + E(X)}{1+n} - \theta\\
= \frac{10-\theta}{11}
\]</span></p>
<p>Above using that we have n=10, and that n iid poisson result in <span class="math inline">\(X \sim POIS(n\theta)\)</span> so the expected value is <span class="math inline">\(n\theta\)</span></p>
<p>With variance:</p>
<p><span class="math display">\[
Var(\frac{X+10}{n+1}) = \frac{Var(X)}{(11)^2} = \frac{10\theta}{121}
\]</span></p>
<p>So the MSE is then:</p>
<p><span class="math display">\[
\frac{(10-\theta)^2 + 10\theta}{121}
\]</span></p>
<p>b)</p>
<p>The MSE for the Bayes estimator under squared error loss, the posterior mean, is lower than the MSE for the MLE from about theta = 6 to theta = 16, so this is “outperforming” the MLE in that narrow range of thetas.</p>
<p>I believe this is the case where the bias does not make as much of a difference, so we’re doing a little better by accepting some bias for a lower variance. However, as theta grows, the tradeoff is no longer worth it, and the MSE is lower for the MLE because of its unbiasedness.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>thetas <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>,<span class="dv">1</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>values <span class="ot">=</span> ((<span class="dv">10</span><span class="sc">-</span>thetas)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">10</span> <span class="sc">*</span> thetas)<span class="sc">/</span><span class="dv">121</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>x_bar_vals <span class="ot">=</span> thetas <span class="sc">/</span> <span class="dv">10</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(thetas,values,<span class="at">type=</span><span class="st">'l'</span>,<span class="at">ylab=</span><span class="st">'mse'</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(thetas,x_bar_vals,<span class="at">type=</span><span class="st">'l'</span>,<span class="at">col=</span><span class="st">'blue'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="section-2" class="level1">
<h1>3</h1>
<p>a)</p>
<p>Bias is calculated below, and is clearly biased though slightly difficult to simplify:</p>
<p><span class="math display">\[
\begin{aligned}
E(\delta_5(X)) &amp; = \frac{E(X) + \sqrt n / 2}{n + \sqrt n } - \theta \\
&amp; = \frac{n\theta + \sqrt n / 2}{n + \sqrt n } - \theta
\end{aligned}
\]</span></p>
<p>variance:</p>
<p><span class="math display">\[
\begin{aligned}
Var(\delta_5(X)) &amp; = \frac{Var(X)}{(n + \sqrt n )^2} \\
&amp; = \frac{n\theta(1-\theta)}{(n + \sqrt n )^2} \\
\end{aligned}
\]</span></p>
<p>and MSE:</p>
<p><span class="math display">\[
\begin{aligned}
&amp; = (\frac{n\theta + \sqrt n / 2}{n + \sqrt n } - \theta)^2 +
\frac{n\theta(1-\theta)}{(n + \sqrt n )^2}\\
&amp; = \frac{1}{4 (1 + \sqrt n)^2}
\end{aligned}
\]</span></p>
<p>b)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>thetas <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.01</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">5</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">=</span> (thetas <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>thetas))<span class="sc">/</span>n</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">=</span> (.<span class="dv">5</span> <span class="sc">-</span> thetas)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>d3 <span class="ot">=</span> (n <span class="sc">*</span> thetas <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>thetas) <span class="sc">+</span> <span class="dv">144</span> <span class="sc">*</span> (<span class="dv">1-2</span><span class="sc">*</span>thetas)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (n<span class="sc">+</span><span class="dv">24</span>)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>d4 <span class="ot">=</span> (n <span class="sc">*</span> thetas <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>thetas)  <span class="sc">+</span> (<span class="dv">1-2</span><span class="sc">*</span>thetas)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (n<span class="sc">+</span><span class="dv">2</span>)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>d5 <span class="ot">=</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">4</span> <span class="sc">*</span> (<span class="fu">sqrt</span>(n) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(thetas,d1,<span class="at">type=</span><span class="st">'l'</span>,<span class="at">col=</span><span class="st">'black'</span>,<span class="at">ylab=</span><span class="st">'mse'</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.10</span>))</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(thetas,d2,<span class="at">col=</span><span class="st">'blue'</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(thetas,d3,<span class="at">col=</span><span class="st">'red'</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(thetas,d4,<span class="at">col=</span><span class="st">'green'</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>d5,<span class="at">col=</span><span class="st">'purple'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">=</span> (thetas <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>thetas))<span class="sc">/</span>n</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">=</span> (.<span class="dv">5</span> <span class="sc">-</span> thetas)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>d3 <span class="ot">=</span> (n <span class="sc">*</span> thetas <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>thetas) <span class="sc">+</span> <span class="dv">144</span> <span class="sc">*</span> (<span class="dv">1-2</span><span class="sc">*</span>thetas)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (n<span class="sc">+</span><span class="dv">24</span>)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>d4 <span class="ot">=</span> (n <span class="sc">*</span> thetas <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>thetas)  <span class="sc">+</span> (<span class="dv">1-2</span><span class="sc">*</span>thetas)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (n<span class="sc">+</span><span class="dv">2</span>)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>d5 <span class="ot">=</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">4</span> <span class="sc">*</span> (<span class="fu">sqrt</span>(n) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(thetas,d1,<span class="at">type=</span><span class="st">'l'</span>,<span class="at">col=</span><span class="st">'black'</span>,<span class="at">ylab=</span><span class="st">'mse'</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.005</span>))</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(thetas,d2,<span class="at">col=</span><span class="st">'blue'</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(thetas,d3,<span class="at">col=</span><span class="st">'red'</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(thetas,d4,<span class="at">col=</span><span class="st">'green'</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>d5,<span class="at">col=</span><span class="st">'purple'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw4_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>c)</p>
<p><span class="math display">\[
\frac{n}{n + \sqrt n}\frac{X}{n} + \frac{\sqrt n}{n + \sqrt n} \frac{1}{2}
\]</span></p>
<p>Just to convince myself, I calculated the weights under n=5 and n=100 below. Even in the low sample size case, we place a low weight of about .3 on our “dumb” prior of 1/2, since this is effectively a made up number. Still, though, we give it some weight if we have almost no observations. With a larger n, we almost completely ignore the static prior.</p>
<p>Since unbiasedness is not useful at all when we have a very small sample size, we don’t really care that 1/2 is biased since it has no variance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">5</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>n <span class="sc">/</span> (<span class="fu">sqrt</span>(n) <span class="sc">+</span> n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.690983</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(n) <span class="sc">/</span> (<span class="fu">sqrt</span>(n) <span class="sc">+</span> n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.309017</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">100</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>n <span class="sc">/</span> (<span class="fu">sqrt</span>(n) <span class="sc">+</span> n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9090909</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(n) <span class="sc">/</span> (<span class="fu">sqrt</span>(n) <span class="sc">+</span> n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.09090909</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>